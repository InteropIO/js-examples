{"version":3,"sources":["webpack:///./src/$_lazy_route_resource lazy namespace object","webpack:///./src/app/app.component.html","webpack:///./src/app/app.component.scss","webpack:///./src/app/app.component.ts","webpack:///./src/app/app.module.ts","webpack:///./src/app/constants/bloomberg-agm-method-names.ts","webpack:///./src/app/constants/glue4office-config.ts","webpack:///./src/app/create-worksheet/create-worksheet.component.html","webpack:///./src/app/create-worksheet/create-worksheet.component.scss","webpack:///./src/app/create-worksheet/create-worksheet.component.ts","webpack:///./src/app/mock-data/worksheet-and-securities.ts","webpack:///./src/app/services/bloomberg.service.ts","webpack:///./src/app/services/excel-service.service.ts","webpack:///./src/app/services/glue.service.ts","webpack:///./src/environments/environment.ts","webpack:///./src/main.ts"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./src/$$_lazy_route_resource lazy recursive\";","module.exports = \"<div class=\\\"container-fluid sticky-top fixed-size-header mb-3\\\">\\n  <div class=\\\"row border border-left-0 border-right-0 border-top-0 border-secondary py-3\\\">\\n    <div class=\\\"col-6\\\">\\n      <h3 class=\\\"text-truncate\\\">\\n        BBG Worksheets Demo\\n      </h3>\\n    </div>\\n    <div class=\\\"col-6 text-right\\\" >\\n      <!-- Control if button is disabled or not with tick42-icon-button-disabled -->\\n      <button type=\\\"button\\\" class=\\\"tick42-icon-horizontal tick42-square-icon-horizontal\\\" [disabled]=\\\"!excelAvailable || currentSecurities.length < 1\\\"\\n        (click)=\\\"exportWorksheet()\\\">\\n        <span class=\\\"tick42-icon-nav bg-info tick42-icon-small\\\">\\n          <span class=\\\"tick42-custom-icon icon-size-16\\\">\\n            <i class=\\\"icon-file-excel\\\"></i>\\n          </span>\\n        </span>\\n        <span class=\\\"tick42-icon-nav-label\\\" >Export to Excel</span>\\n      </button>\\n    </div>\\n  </div>\\n</div>\\n\\n<div class=\\\"container-fluid\\\">\\n  <div class=\\\"row\\\" *ngIf=\\\"bloombergAvailable\\\">\\n    <div class=\\\"col\\\">\\n      <div class=\\\"card\\\">\\n        <!-- Switch card-body when you change tabs -->\\n        <div class=\\\"card-body\\\">\\n          <div class=\\\"row\\\">\\n            <div class=\\\"col\\\">\\n              <h5 class=\\\"card-title mt-1 mb-0\\\">Created Worksheets</h5>\\n            </div>\\n            <div class=\\\"col text-right\\\">\\n              <button type=\\\"button\\\" class=\\\"btn btn-primary\\\" data-toggle=\\\"modal\\\" (click)=\\\"createWorksheet()\\\">\\n                Create Worksheet\\n              </button>\\n            </div>\\n          </div>\\n          <ul class=\\\"list-group list-group-flush\\\">\\n            <li class=\\\"list-group-item\\\" *ngFor=\\\"let worksheet of worksheets\\\" id=\\\"{{ worksheet.id }}\\\" [class.active]=\\\"worksheet.id === currentWorksheet?.id\\\"\\n              (click)=\\\"selectWorksheet(worksheet)\\\">\\n              {{worksheet.name}}\\n            </li>\\n          </ul>\\n\\n        </div>\\n\\n      </div>\\n    </div>\\n    <div class=\\\"col\\\">\\n      <div class=\\\"card\\\">\\n        <div class=\\\"card-body\\\">\\n          <div class=\\\"row\\\">\\n            <div class=\\\"col\\\">\\n              <h5 class=\\\"card-title mt-1 mb-0\\\">Securities</h5>\\n            </div>\\n            <div class=\\\"col text-right\\\">\\n              <!-- <div class=\\\"dropdown\\\">\\n                <button class=\\\"btn btn-primary dropdown-toggle\\\" type=\\\"button\\\" id=\\\"dropdownMenuButton\\\" data-toggle=\\\"dropdown\\\"\\n                  aria-haspopup=\\\"true\\\" aria-expanded=\\\"true\\\">\\n                  Add Entry\\n                </button>\\n                <div class=\\\"dropdown-menu dropdown-menu-right visible\\\" aria-labelledby=\\\"dropdownMenuButton\\\"\\n                  x-placement=\\\"bottom-start\\\" style=\\\"right: 0\\\">\\n                  <a class=\\\"dropdown-item\\\" *ngFor=\\\"let security of getSecuritiesToAppend()\\\" (click)=\\\"appendSecurityToSheet(security)\\\"\\n                    href=\\\"#\\\">{{ security }}</a>\\n                </div>\\n              </div> -->\\n              <div ngbDropdown>\\n                <button class=\\\"btn btn-primary\\\" type=\\\"button\\\" id=\\\"dropdownMenuButton\\\" [disabled]=\\\"!currentWorksheet\\\"\\n                  ngbDropdownToggle>\\n                  Add Entry\\n                </button>\\n                <div class=\\\"dropdown-menu dropdown-menu-right visible\\\" aria-labelledby=\\\"dropdownMenuButton\\\"\\n                  ngbDropdownMenu>\\n                  <a class=\\\"dropdown-item\\\" *ngFor=\\\"let security of getSecuritiesToAppend()\\\" (click)=\\\"appendSecurityToSheet(security)\\\"\\n                    href=\\\"#\\\">{{ security }}</a>\\n                </div>\\n              </div>\\n            </div>\\n          </div>\\n          <ul class=\\\"list-group list-group-flush securities\\\">\\n            <li class=\\\"list-group-item\\\" *ngFor=\\\"let security of currentSecurities\\\" (click)=\\\"selectSecurity(security)\\\">\\n              {{security}}\\n              <!-- <i class=\\\"icon-cancel text-danger\\\" (click)=\\\"removeSecurity(security)\\\"></i> -->\\n            </li>\\n            <li class=\\\"list-group-item\\\" *ngIf=\\\"currentSecurities.length < 1 && currentWorksheet\\\">No securities added</li>\\n          </ul>\\n        </div>\\n      </div>\\n    </div>\\n\\n  </div>\\n\\n  <div class=\\\"row\\\" *ngIf=\\\"!bloombergAvailable\\\">\\n    <div class=\\\"col-12\\\">\\n      <div class=\\\"jumbotron\\\">\\n        <h1 class=\\\"display-4\\\">Bloomberg Bridge not available</h1>\\n        <hr class=\\\"my-4\\\">\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n\\n<div class=\\\"container-fluid fixed-bottom\\\" style=\\\"background-color: #152327\\\">\\n  <div class=\\\"row py-2\\\">\\n    <div class=\\\"col-6\\\">\\n      <div class=\\\"logo-container\\\"></div>\\n    </div>\\n    <div class=\\\"col-6\\\">\\n      <div class=\\\"d-flex status-container\\\" style=\\\"justify-content: flex-end\\\">\\n        <div class=\\\"d-inline\\\">\\n          <small class=\\\"status-connected small\\\">\\n            <span class=\\\"tick42-custom-icon icon-inherit-color icon-size-12\\\" [ngClass]=\\\"{'text-success': bloombergAvailable, 'text-danger': !bloombergAvailable}\\\">\\n              <i class=\\\"icon-record\\\"></i>\\n            </span>\\n            Bloomberg\\n            <!-- {{glueConnected ? 'Connected' : 'Disconnected'}} -->\\n          </small>\\n          <small class=\\\"status-connected small\\\">\\n            <span class=\\\"tick42-custom-icon icon-inherit-color icon-size-12\\\" [ngClass]=\\\"{'text-success': glueConnected, 'text-danger': !glueConnected}\\\">\\n              <i class=\\\"icon-record\\\"></i>\\n            </span>\\n            Glue\\n            <!-- {{glueConnected ? 'Connected' : 'Disconnected'}} -->\\n          </small>\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n\"","module.exports = \".container,\\n.row {\\n  padding-top: 20px; }\\n\\nli:hover {\\n  cursor: pointer; }\\n\\nbutton.btn.btn-primary {\\n  margin-left: 15px; }\\n\\n.securities .icon-cancel {\\n  opacity: 0;\\n  transition: all .25s ease;\\n  position: absolute;\\n  right: 1.25rem;\\n  top: 50%;\\n  -webkit-transform: translateY(-50%);\\n          transform: translateY(-50%); }\\n\\n.securities .list-group-item:hover .icon-cancel {\\n  opacity: 1; }\\n\\n.list-group-flush .list-group-item {\\n  cursor: pointer;\\n  transition: all .25s ease; }\\n\\n.list-group-flush .list-group-item:hover {\\n  padding-left: 1.5rem;\\n  color: #d1da27; }\\n\\n.dropdown-menu-right[style] {\\n  right: 0 !important;\\n  left: unset !important; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvQzpcXGRldmVsb3BtZW50XFxhbGwtZW50ZXJwcmlzZS1kZW1vc1xcYmJnLXdvcmtzaGVldC1kZW1vXFxiYmctd29ya3NoZWV0LWRlbW8vc3JjXFxhcHBcXGFwcC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7RUFFSSxrQkFBaUIsRUFDcEI7O0FBRUQ7RUFDSSxnQkFBZSxFQUNsQjs7QUFFRDtFQUNJLGtCQUFpQixFQUNwQjs7QUFFRDtFQUNFLFdBQVU7RUFFViwwQkFBeUI7RUFDekIsbUJBQWtCO0VBQ2xCLGVBQWM7RUFDZCxTQUFRO0VBQ1Isb0NBQTJCO1VBQTNCLDRCQUEyQixFQUM1Qjs7QUFFRDtFQUNFLFdBQVUsRUFDWDs7QUFFRDtFQUNFLGdCQUFlO0VBRWYsMEJBQXlCLEVBQzFCOztBQUVEO0VBQ0UscUJBQW9CO0VBQ3BCLGVBQWMsRUFDZjs7QUFFRDtFQUNFLG9CQUFrQjtFQUNsQix1QkFBcUIsRUFDdEIiLCJmaWxlIjoic3JjL2FwcC9hcHAuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuY29udGFpbmVyLFxuLnJvdyB7XG4gICAgcGFkZGluZy10b3A6IDIwcHg7XG59XG5cbmxpOmhvdmVyIHtcbiAgICBjdXJzb3I6IHBvaW50ZXI7XG59XG5cbmJ1dHRvbi5idG4uYnRuLXByaW1hcnkge1xuICAgIG1hcmdpbi1sZWZ0OiAxNXB4O1xufVxuXG4uc2VjdXJpdGllcyAuaWNvbi1jYW5jZWwge1xuICBvcGFjaXR5OiAwO1xuICAtd2Via2l0LXRyYW5zaXRpb246IGFsbCAuMjVzIGVhc2U7XG4gIHRyYW5zaXRpb246IGFsbCAuMjVzIGVhc2U7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgcmlnaHQ6IDEuMjVyZW07XG4gIHRvcDogNTAlO1xuICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwJSk7XG59XG5cbi5zZWN1cml0aWVzIC5saXN0LWdyb3VwLWl0ZW06aG92ZXIgLmljb24tY2FuY2VsIHtcbiAgb3BhY2l0eTogMTtcbn1cblxuLmxpc3QtZ3JvdXAtZmx1c2ggLmxpc3QtZ3JvdXAtaXRlbSB7XG4gIGN1cnNvcjogcG9pbnRlcjtcbiAgLXdlYmtpdC10cmFuc2l0aW9uOiBhbGwgLjI1cyBlYXNlO1xuICB0cmFuc2l0aW9uOiBhbGwgLjI1cyBlYXNlO1xufVxuXG4ubGlzdC1ncm91cC1mbHVzaCAubGlzdC1ncm91cC1pdGVtOmhvdmVyIHtcbiAgcGFkZGluZy1sZWZ0OiAxLjVyZW07XG4gIGNvbG9yOiAjZDFkYTI3O1xufVxuXG4uZHJvcGRvd24tbWVudS1yaWdodFtzdHlsZV0ge1xuICByaWdodDogMCFpbXBvcnRhbnQ7XG4gIGxlZnQ6IHVuc2V0IWltcG9ydGFudDtcbn1cblxuXG4iXX0= */\"","import { Component, OnDestroy, ViewChild } from '@angular/core';\nimport { BloombergService } from './services/bloomberg.service';\nimport { Worksheet } from './models/worksheet';\nimport { ExcelService } from './services/excel-service.service';\nimport { Security } from './models/securities.model';\nimport { securities } from './mock-data/worksheet-and-securities';\nimport { NgbDropdownConfig, NgbModal } from '@ng-bootstrap/ng-bootstrap';\nimport { GlueService } from './services/glue.service';\nimport { CreateWorksheetComponent } from './create-worksheet/create-worksheet.component';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.scss']\n})\nexport class AppComponent implements OnDestroy {\n  public readonly title = 'bbg-worksheet-demo';\n\n  public securities: string[] = securities;\n  public worksheets: Worksheet[] = [];\n\n  public currentSecurities: string[] = [];\n  public currentWorksheet: Worksheet;\n\n  public worksheetDialogOpened = true;\n  public excelAvailable = false;\n  public glue: any;\n  public glueConnected = false;\n  public bloombergAvailable = false;\n\n  @ViewChild('createWorksheetDialog') public readonly createWorksheetDialog;\n\n  constructor(private glueService: GlueService,\n    private excelServiceService: ExcelService,\n    private bloombergService: BloombergService,\n    config: NgbDropdownConfig,\n    private modalService: NgbModal) {\n\n      this.glueService.getGlueInstance()\n      .then(glue => {\n        this.glue = glue;\n\n        this.glue.connection.connected(() => {\n          this.glueConnected = true;\n        });\n\n        this.glue.connection.disconnected(() => {\n          this.glueConnected = false;\n        });\n\n        return glue.excel.ready();\n      }).then(() => {\n        this.excelAvailable = this.glue.excel.addinStatus;\n        this.glue.excel.onAddinStatusChanged((newStatus) => {\n          this.excelAvailable = newStatus;\n        });\n      });\n\n    this.fetchWorksheets();\n\n    this.excelServiceService.getSecurities()\n      .subscribe((newSecurities) => {\n        if (!newSecurities) {\n          return;\n        }\n        this.currentSecurities = newSecurities.map(s => s.ticker);\n      });\n\n    this.watchForChanges();\n\n    (config as any)['placement'] = 'bottom-start';\n  }\n\n  public ngOnDestroy(): void {\n  }\n\n  fetchWorksheets() {\n    if (this.bloombergAvailable) {\n      this.bloombergService.getWorksheets()\n      .then(sheets => this.worksheets = sheets)\n      .catch(err => {\n\n      });\n    }\n  }\n\n  watchForChanges() {\n    setInterval(() => {\n      this.fetchWorksheets();\n    }, 1000);\n\n    this.glueService.getGlueInstance()\n      .then(glue => {\n        glue.agm.methodAdded(method => {\n          if (method.name === 'T42.BBG.GetWorksheets') {\n            this.bloombergAvailable = true;\n            this.fetchWorksheets();\n          }\n        });\n\n        glue.agm.methodRemoved(method => {\n          if (method.name === 'T42.BBG.GetWorksheets') {\n            this.bloombergAvailable = false;\n            this.currentWorksheet = null;\n            this.currentSecurities = [];\n          }\n        });\n      });\n  }\n\n  public async selectWorksheet(worksheet): Promise<void> {\n    const { id } = worksheet;\n\n    this.currentSecurities = await this.bloombergService.getWorksheetSecurities(id);\n    this.currentWorksheet = worksheet;\n  }\n\n  public selectSecurity(security) {\n    this.glue.channels.publish({\n      partyPortfolio: {\n        ric: security\n      }\n    });\n  }\n\n  public async createWorksheet(): Promise<void> {\n    this.worksheetDialogOpened = true;\n    // this.createWorksheetDialog.show();\n\n    const modalRef = this.modalService.open(CreateWorksheetComponent);\n    modalRef.result.then(worksheetName => {\n      if (worksheetName) {\n        this.bloombergService.createWorksheet(worksheetName).then(async () => {\n          this.worksheets = await this.bloombergService.getWorksheets();\n        });\n      }\n    }).catch(() => {\n      console.log('modal dismissed');\n    });\n  }\n\n  public appendSecurityToSheet(security: string): Promise<any> {\n    return this.bloombergService.appendWorksheetSecurities([security], this.currentWorksheet.id)\n        .then(async () => {\n          this.currentSecurities = await this.bloombergService.getWorksheetSecurities(this.currentWorksheet.id);\n          this.exportWorksheet(true);\n        });\n  }\n\n  public removeSecurity(security: string) {\n    // console.log(this.currentSecurities, security);\n    // this.currentSecurities = this.currentSecurities.filter(s => s !== security);\n    this.bloombergService.removeWorksheetSecurities([security], this.currentWorksheet.id)\n    .then(async () => {\n      // this.currentSecurities = await this.bloombergService.getWorksheetSecurities(this.currentWorksheet.id);\n      // this.exportWorksheet(true)\n    });\n  }\n\n  public async exportWorksheet(updateOnly: boolean = false): Promise<void> {\n    if (this.excelAvailable) {\n      console.log('export worksheet');\n      this.excelServiceService.openSheet(this.currentWorksheet, this.currentSecurities, updateOnly);\n    }\n  }\n\n  public getSecuritiesToAppend() {\n    return this.securities.filter(security => {\n      return !this.currentSecurities.find(cs => cs === security);\n    });\n  }\n}\n","import { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\n\nimport { AppComponent } from './app.component';\nimport { GlueService } from './services/glue.service';\nimport { BloombergService } from './services/bloomberg.service';\nimport { ExcelService } from './services/excel-service.service';\nimport { CreateWorksheetComponent } from './create-worksheet/create-worksheet.component';\nimport { NgbModule } from '@ng-bootstrap/ng-bootstrap';\nimport { FormsModule } from '@angular/forms';\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    CreateWorksheetComponent\n  ],\n  imports: [\n    BrowserModule,\n    FormsModule,\n    NgbModule.forRoot()\n  ],\n  providers: [GlueService, BloombergService, ExcelService],\n  bootstrap: [AppComponent],\n  entryComponents: [CreateWorksheetComponent]\n})\nexport class AppModule { }\n","export const createWorksheet = 'T42.BBG.CreateWorksheet';\nexport const getWorksheets = 'T42.BBG.GetWorksheets';\nexport const getWorksheetSecurities = 'T42.BBG.GetWorksheetSecurities';\nexport const appendWorksheetSecurities = 'T42.BBG.AppendWorksheetSecurities';\nexport const removeWorksheetSecurities = 'T42.BBG.RemoveWorksheetSecurities';\nexport const setWorksheetSecurities = 'T42.BBG.SetWorksheetSecurities';\n","export const glueConfig: any = {\n    gateway: {\n        ws: 'ws://localhost:8385/gw',\n        protocolVersion: 3\n    },\n    auth: {\n        username: 't42demo',\n        password: 't42demo'\n    },\n    word: false,\n    excel: true,\n    outlook: false,\n    appManager: false,\n    contexts: false\n};\n","module.exports = \"<div class=\\\"modal-header\\\">\\n  <h5 class=\\\"modal-title\\\" id=\\\"exampleModalLabel\\\">Create New Worksheet</h5>\\n  <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"modal\\\" aria-label=\\\"Close\\\">\\n    <span aria-hidden=\\\"true\\\">Ã—</span>\\n  </button>\\n</div>\\n<div class=\\\"modal-body\\\">\\n  <form>\\n    <div class=\\\"form-group\\\">\\n      <label for=\\\"worksheetName\\\" class=\\\"col-form-label\\\">Worksheet Name:</label>\\n      <input type=\\\"text\\\" class=\\\"form-control\\\" id=\\\"worksheetName\\\" autocomplete=\\\"off\\\" [(ngModel)]=\\\"worksheetName\\\" [ngModelOptions]=\\\"{standalone: true}\\\">\\n    </div>\\n  </form>\\n</div>\\n<div class=\\\"modal-footer\\\">\\n  <button type=\\\"button\\\" class=\\\"btn btn-secondary\\\" data-dismiss=\\\"modal\\\" (click)=\\\"close()\\\">Close</button>\\n  <button type=\\\"button\\\" class=\\\"btn btn-primary\\\" (click)=\\\"create()\\\">Create</button>\\n</div>\\n\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2NyZWF0ZS13b3Jrc2hlZXQvY3JlYXRlLXdvcmtzaGVldC5jb21wb25lbnQuc2NzcyJ9 */\"","import { Component, OnInit } from '@angular/core';\nimport { NgbActiveModal } from '@ng-bootstrap/ng-bootstrap';\n\n@Component({\n  selector: 'app-create-worksheet',\n  templateUrl: './create-worksheet.component.html',\n  styleUrls: ['./create-worksheet.component.scss']\n})\nexport class CreateWorksheetComponent implements OnInit {\n  public result: Promise<string>;\n  public isHidden = true;\n  public worksheetName = '';\n\n  constructor(public activeModal: NgbActiveModal, ) { }\n\n  public ngOnInit() {\n  }\n\n  close() {\n    this.activeModal.dismiss();\n  }\n\n  create() {\n    this.activeModal.close(this.worksheetName);\n    this.worksheetName = '';\n  }\n\n  public show() {\n    this.isHidden = false;\n\n    this.result = new Promise((resolve) => {\n      setTimeout(() => resolve('Worksheet ' + Math.random()), 1000);\n    });\n  }\n\n  public hide() {\n    this.isHidden = true;\n  }\n}\n","export const securities: string[] = ['VOD LN Equity',\n  'BARC LN Equity',\n  'BMW GR Equity',\n  'AAL LN Equity',\n  'GOOGL US Equity',\n  'MSFT US Equity',\n  'TEAM US Equity',\n  'CRM US Equity',\n  'JPM US Equity',\n  'FB US Equity',\n  'AMZN US Equity',\n  'AAPL US Equity',\n  'BABA US Equity',\n  'TICK Index',\n  'NTES US Equity',\n  'KHC US Equity',\n  'NFLX US Equity',\n  'TSCO LN Equity'];\n","import { Injectable } from '@angular/core';\nimport { Worksheet } from '../models/worksheet';\nimport { GlueService } from './glue.service';\n// tslint:disable-next-line:max-line-length\nimport { createWorksheet, appendWorksheetSecurities, removeWorksheetSecurities, getWorksheets, getWorksheetSecurities, setWorksheetSecurities } from '../constants/bloomberg-agm-method-names';\n\n@Injectable()\nexport class BloombergService {\n  constructor(private glueService: GlueService) { }\n\n  public async createWorksheet(name: string): Promise<Worksheet> {\n    const glue4office = await this.glueService.getGlueInstance();\n\n    console.log('createWorksheet ' + name);\n    return glue4office.agm.invoke(createWorksheet, { name })\n      .then(result => result.returned._result);\n  }\n\n  public async getWorksheets(): Promise<Worksheet[]> {\n    const glue4office = await this.glueService.getGlueInstance();\n    return glue4office.agm.invoke(getWorksheets).then(result => result.returned.worksheets);\n  }\n\n  public async getWorksheetSecurities(worksheetId: string): Promise<string[]> {\n    const glue4office = await this.glueService.getGlueInstance();\n\n    return glue4office.agm.invoke(getWorksheetSecurities, { worksheetId })\n      .then(result => {\n        return result.returned.securities;\n      });\n  }\n\n  public async appendWorksheetSecurities(securities: string[], worksheetId: string): Promise<any> {\n    const glue4office = await this.glueService.getGlueInstance();\n    return glue4office.agm.invoke(appendWorksheetSecurities, { securities, worksheetId })\n      .then(console.log);\n  }\n\n  public async setWorksheetSecurities(securities: string[], worksheetId: string): Promise<any> {\n    const glue4office = await this.glueService.getGlueInstance();\n    return glue4office.agm.invoke(setWorksheetSecurities, { securities, worksheetId })\n      .then(console.log);\n  }\n\n  public async removeWorksheetSecurities(securities: string[], worksheetId: string): Promise<any> {\n    const glue4office = await this.glueService.getGlueInstance();\n\n    return glue4office.agm\n      .invoke(removeWorksheetSecurities, { securities, worksheetId })\n      .then(result => result.returned._result);\n  }\n\n  public fetchData() {\n    setInterval(() => console.log('Fetched data successfully!'), 10000);\n  }\n\n  public onData(callback: () => void): void {\n\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Worksheet } from '../models/worksheet';\nimport { Security } from '../models/securities.model';\nimport { GlueService } from './glue.service';\nimport { ExcelConfig, Sheet } from '../models/excel-config.model';\nimport { Subscription, Observable, BehaviorSubject } from 'rxjs';\nimport { BloombergService } from './bloomberg.service';\n\n@Injectable()\nexport class ExcelService {\n  private glue4office;\n  private openedSheets: { worksheetId: string, excelSheet: any }[] = [];\n  private $securities: BehaviorSubject<any> = new BehaviorSubject(null);\n\n  constructor(\n    private glueService: GlueService,\n    private bloombergService: BloombergService\n  ) {\n    this.glueService.getGlueInstance()\n      .then(glue => this.glue4office = glue)\n      .catch(console.error);\n  }\n\n  public getSecurities(): Observable<any> {\n    return this.$securities.asObservable();\n  }\n\n  private setSecurities(newSecurities: Security[]) {\n    this.$securities.next(newSecurities);\n  }\n\n  public openSheet(worksheet: Worksheet, securities: string[], updateOnly): any {\n    if (securities.length === 0) {\n      securities = [''];\n    }\n\n    const config: any = this.getExcelConfig(worksheet.name, securities);\n\n    const openedSheet = this.openedSheets.find(s => s.worksheetId === worksheet.id);\n\n    if (openedSheet) {\n      openedSheet.excelSheet.update(securities.map(ticker => ({ ticker })));\n    } else {\n      if (updateOnly) {\n        return;\n      }\n\n      return this.glue4office.excel.openSheet(config)\n      .then((sheet: Sheet) => {\n        sheet.onChanged((data, _, done) => {\n          this.setSecurities(data);\n          data = data.map(security => security.ticker);\n          this.bloombergService.setWorksheetSecurities(data, worksheet.id);\n          done();\n        });\n\n        this.openedSheets.push({\n          worksheetId: worksheet.id,\n          excelSheet: sheet\n        });\n      });\n    }\n  }\n\n  public onDataChanged() {\n\n  }\n\n  private getExcelConfig(name: string, securities: string[]): any {\n    return {\n      columnConfig: [\n        { header: 'Securities', fieldName: 'ticker', width: 12 },\n      ],\n      options: {\n        // clearGrid: true,\n        // dataRangeName: `worksheet`,\n        // inhibitLocalSave: false,\n        // response: `image`,\n        // topLeft: `A2`,\n        // buttonRange: `A1:C1`,\n        // buttonText: `Send Data`,\n        workbook: name + '.xls',\n        worksheet: name,\n        updateTrigger: [\n          'save',\n          'row'\n        ]\n      },\n      data: securities.map(ticker => ({ ticker }))\n    };\n  }\n\n}\n","import { Injectable } from '@angular/core';\nimport { glueConfig } from '../constants/glue4office-config';\n\ndeclare var Glue: any;\ndeclare var Glue4Office: any;\ndeclare var glue42gd: any;\n\n@Injectable()\nexport class GlueService {\n  private glue: any;\n  private gluePromise: Promise<any>;\n\n  public getGlueInstance(): Promise<any> {\n    if (!this.gluePromise) {\n      this.gluePromise = this.initializeGlue();\n    }\n    return this.gluePromise;\n  }\n\n  private async initializeGlue(): Promise<any> {\n    glueConfig.gateway.ws = (window['glue42gd'] && glue42gd.gwUrl) || glueConfig.gateway.ws;\n    glueConfig.auth.username = (window['glue42gd'] && glue42gd.user) || glueConfig.auth.username;\n\n    console.log('Will initialize Glue with config', glueConfig);\n\n    const glue = await Glue(glueConfig);\n    glueConfig.glue = glue;\n    this.glue = await Glue4Office(glueConfig);\n\n    window['glue'] = glue;\n\n    return new Promise((resolve, reject) => {\n      if (!this.glue) {\n        reject(false);\n      }\n\n      resolve(this.glue);\n    });\n  }\n}\n","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n"],"sourceRoot":""}